---
title: "SwiftUIã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«xcappdataã‚’è‡ªå‹•å±•é–‹ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ”„"
type: "tech"
topics: ["iOS", "SwiftUI", "SwiftData", "Migration", "xcappdata"]
published: true
---

# ã¯ã˜ã‚ã«
iOSã‚¢ãƒ—ãƒªé–‹ç™ºã«ãŠã„ã¦ã€ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã¯é¿ã‘ã¦é€šã‚Œãªã„è¦ç´ ã§ã™ã€‚ç‰¹ã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®å¤‰æ›´ã‚„ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ä¼´ã†ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆã¯ã€é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã§é‡è¦ãªã‚¹ãƒ†ãƒƒãƒ—ã¨ãªã‚Šã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€`SwiftUI`ã€`SwiftData`ã‚’åˆ©ç”¨ã—ãŸé–‹ç™ºä¸­ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çŠ¶æ…‹ã‚’ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«è‡ªå‹•ã§å¾©å…ƒã™ã‚‹æ–¹æ³•ã‚’ã€`xcappdata`ã‚’ä½¿ç”¨ã—ã¦å®Ÿç¾ã™ã‚‹æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## æ¤œè¨¼ç’°å¢ƒ
- Xcodeãƒãƒ¼ã‚¸ãƒ§ãƒ³: 15.2

# xcappdataã¨ã¯ï¼Ÿ
`xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€iOSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å«ã‚€ã‚³ãƒ³ãƒ†ãƒŠã§ã™ã€‚é–‹ç™ºä¸­ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ç‰¹å®šã®ãƒ‡ãƒ¼ã‚¿çŠ¶æ…‹ã‚’ç°¡å˜ã«å†ç¾ã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚’äº‹å‰ã«è¨­å®šã•ã‚ŒãŸçŠ¶æ…‹ã«å¾©å…ƒã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

## å•é¡Œç‚¹
ã‚¹ã‚­ãƒ¼ãƒè¨­å®šå†…ã®App Dataã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§`xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã€ãƒ‡ãƒãƒƒã‚°èµ·å‹•æ™‚ã«è‡ªå‹•ã§ãƒ‡ãƒ¼ã‚¿ãŒå±•é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã—ãŸãŒã€æœŸå¾…é€šã‚Šã«å‹•ä½œã—ã¾ã›ã‚“ã§ã—ãŸã€‚ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®æ–¹æ³•ã‚’è©¦ã¿ã¾ã—ãŸã€‚

# è§£æ±ºç­–
1. `xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã™ã‚‹
2. ãƒ“ãƒ«ãƒ‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«`xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹
   - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®`Build Phases`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ã‚‹`Copy Bundle Resources`ã«xcappdataãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚
   - å½“è©²`xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã€`Target Membership`ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’ã¤ã‘ã‚‹ã“ã¨ã§ã‚‚å¯¾å¿œã§ãã¾ã™ã€‚
3. `AppDelegate`ã§ã®å‡¦ç†è¿½åŠ 
   - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•æ™‚ã«ã€`xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

## SwiftUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®å®Ÿè£…ä¾‹
`SwiftUI`ã§ã¯ã€å¾“æ¥ã®`AppDelegate`ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ãŸã‚ã«`@UIApplicationDelegateAdaptor`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`SwiftUI`ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å†…ã§`AppDelegate`ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ä»¥ä¸‹ã¯ã€`xcappdata`ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’`Application Support`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã™ã‚‹å‡¦ç†ã‚’å«ã‚ãŸä¾‹ã§ã™ã€‚

```Swift
import SwiftUI

@main
struct YourApp: App {
    @UIApplicationDelegateAdaptor(AppDelegate.self) var appDelegate
    
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}

class AppDelegate: NSObject, UIApplicationDelegate {
    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {
        if let xcappdataApplicaitonSupportUrl =
            Bundle.main.url(forResource: "jp.co.your.app", withExtension: "xcappdata")?
                .appendingPathComponent("AppData")
                .appendingPathComponent("Library")
                .appendingPathComponent("Application Support")
        {
            let applicaitonSupportUrl = FileManager.default.urls(for: .applicationSupportDirectory, in: .userDomainMask).first!
            
            do {
                try FileManager.default.copyItem(at: xcappdataApplicaitonSupportUrl, to: applicaitonSupportUrl)
                // `Application Support`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç›´å¾Œã¯å­˜åœ¨ã—ãªã„ãŸã‚ã€åˆå›ã¯æˆåŠŸã™ã‚‹
                print("Successfully copied the contents of the xcappdata file to the Application Support directory.")
            } catch {
                print("Failed to copy the contents of the xcappdata file to the Application Support directory.")
            }
        }
        return true
    }
}
```

## æ³¨æ„ç‚¹
ã“ã®æ–¹æ³•ã§ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã™ã‚‹å ´åˆã€ãƒ†ã‚¹ãƒˆã‚„ãƒ‡ãƒãƒƒã‚°ä»¥å¤–ã®ç›®çš„ã§ã¯ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
xcappdataã‚’å«ã‚“ã ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ãƒ‰ãƒ«ã¯ã€App Storeã«æå‡ºã™ã‚‹ã“ã¨ãŒã§ããªã„ã‚ˆã†ã§ã™ã€‚

## ã¾ã¨ã‚
ã“ã®è¨˜äº‹ã§ã¯ã€Swiftã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãŸã‚ã®`xcappdata`ã®æ´»ç”¨æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚ã“ã®æ–¹æ³•ã‚’ä½¿ã†ã“ã¨ã§ã€é–‹ç™ºä¸­ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆã‚„ãƒ‡ãƒãƒƒã‚°ã‚’ã‚ˆã‚Šè¿…é€Ÿã«ã€ãã—ã¦ç¢ºå®Ÿã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒãƒ—ãƒ­ã‚»ã‚¹ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ã§ã€é–‹ç™ºè€…ã¯ã‚ˆã‚Šæœ¬è³ªçš„ãªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ”¹å–„ã«é›†ä¸­ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã“ã®æ–¹æ³•ãŒã€`SwiftUI`ã€`SwiftData`ã‚’ä½¿ã£ãŸiOSã‚¢ãƒ—ãƒªé–‹ç™ºã‚’è¡Œã†çš†ã•ã‚“ã®å½¹ã«ç«‹ã¤ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚
